import{n as a}from"./index.14d0df4d.js";import{_ as r}from"./map-area.3155d1f1.js";import{_ as m,k as y,l as g,P as h}from"./map-main.86616354.js";import{m as u}from"./vue.200a03fd.js";import"./vuetify.48d02596.js";/* empty css                            */const b={directives:{drag(l,e){l.onmousedown=function(t){t.stopPropagation();let o=t.pageX-l.offsetLeft,s=t.pageY-l.offsetTop;document.body.onselectstart=function(){return!1},document.onmousemove=function(c){s>60||(l.style.left=c.pageX-o+"px",l.style.top=c.pageY-s+"px")},document.onmouseup=function(){document.onmousemove=document.onmouseup=null,document.body.onselectstart=null}}}},props:{fixed:{type:Boolean,default:!0}}};var _=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"drag",rawName:"v-drag"}],staticClass:"drag",class:{position:e.fixed}},[e._t("default")],2)},f=[],v=a(b,_,f,!1,null,"1a9ee3e5",null,null);const p=v.exports;const x={components:{MapDrag:p},data(){return{symbol:{name:"",description:"",tag:"",textName:"",textSize:12,lineWidth:1,lineColor:"#409EFF",lineOpacity:1,polygonOpacity:.1,polygonFill:"#409EFF"},name:"",description:"",tag:"",textName:"",textSize:12,lineWidth:1,lineColor:"#409EFF",lineOpacity:1,polygonOpacity:.1,polygonFill:"#409EFF",item:{},isShow:!1,styleP:{top:"130px",left:"450px"}}},methods:{open(l){this.item=l,this.symbol=l.geo.getSymbol(),this.isShow=!0;let e=l.xy;this.styleP={top:`${e.y}px`,left:`${e.x}px`}},close(){this.isShow=!1},setSymbol(l,e){let o={...l.getSymbol(),...e};l.setSymbol(o)},callback(l,e){let t=this.symbol;switch(l){case"name":t={name:e};break;case"description":t={description:e};break;case"tag":t={tag:e};break;case"textName":t={textName:e};break;case"textSize":t={textSize:e};break;case"lineWidth":t={lineWidth:e};break;case"lineColor":t={lineColor:e};break;case"lineOpacity":t={lineOpacity:e};break;case"polygonOpacity":t={polygonOpacity:e};break;case"polygonFill":t={polygonFill:e};break;case"fontFrameColor":t={markerFill:e};break;case"textSize":t={textSize:e};break}this.setSymbol(this.item.geo,t)},handleWidthChange(l){this.callback("lineWidth",l)},handletextSizeChange(l){this.callback("textSize",l)},handlelineColorChange(l){this.callback("lineColor",l)},handleLineAlphaChange(l){this.callback("lineOpacity",l)},handlePolygonOpacity(l){this.callback("polygonOpacity",l)},handlePolygonFillChange(l){this.callback("polygonFill",l)}}};var k=function(){var e=this,t=e._self._c;return t(p,{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"detail-position",style:e.styleP,attrs:{fixed:!1}},[t("div",{staticClass:"detail-dialog"},[t("header",{staticClass:"title clip"},[e._v(" \u7F16\u8F91\u9762\u677F "),t("span",{staticClass:"close",on:{click:e.close}},[e._v("x")])]),t("main",[t("div",{staticClass:"l-h"},[t("label",[e._v("\u540D\u79F0\uFF1A")]),t("el-input",{staticStyle:{width:"220px"},attrs:{size:"small"},on:{change:function(o){return e.callback("name",e.name)}},model:{value:e.symbol.name,callback:function(o){e.$set(e.symbol,"name",o)},expression:"symbol.name"}})],1),t("div",{staticClass:"l-h"},[t("label",[e._v("\u63CF\u8FF0\uFF1A")]),t("el-input",{staticStyle:{width:"220px"},attrs:{size:"small"},on:{change:function(o){return e.callback("description",e.description)}},model:{value:e.symbol.description,callback:function(o){e.$set(e.symbol,"description",o)},expression:"symbol.description"}})],1),t("div",{staticClass:"l-h"},[t("label",[e._v("\u6807\u7B7E\uFF1A")]),t("el-input",{staticStyle:{width:"220px"},attrs:{size:"small"},on:{change:function(o){return e.callback("tag",e.tag)}},model:{value:e.symbol.tag,callback:function(o){e.$set(e.symbol,"tag",o)},expression:"symbol.tag"}})],1),t("div",{staticClass:"l-h"},[t("label",[e._v("\u663E\u793A\u540D\u79F0\uFF1A")]),t("el-input",{staticStyle:{width:"188px"},attrs:{size:"small"},on:{change:function(o){return e.callback("textName",e.textName)}},model:{value:e.symbol.textName,callback:function(o){e.$set(e.symbol,"textName",o)},expression:"symbol.textName"}})],1),t("div",{staticClass:"l-h"},[t("label",[e._v("\u5B57\u4F53\u5927\u5C0F\uFF1A")]),t("el-input-number",{attrs:{min:1,max:40,size:"small"},on:{change:function(o){return e.callback("textSize",e.textSize)}},model:{value:e.symbol.textSize,callback:function(o){e.$set(e.symbol,"textSize",o)},expression:"symbol.textSize"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.type=="polygon",expression:"item.type=='polygon'"}],staticClass:"l-h"},[t("label",[e._v("\u7EBF\u5BBD\uFF1A")]),t("el-input-number",{attrs:{min:1,max:10,size:"small"},on:{change:function(o){return e.callback("lineWidth",e.lineWidth)}},model:{value:e.symbol.lineWidth,callback:function(o){e.$set(e.symbol,"lineWidth",o)},expression:"symbol.lineWidth"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.type=="polygon",expression:"item.type=='polygon'"}],staticClass:"l-h"},[t("label",[e._v("\u7EBF\u989C\u8272\uFF1A")]),t("el-color-picker",{on:{change:function(o){return e.callback("lineColor",e.lineColor)}},model:{value:e.symbol.lineColor,callback:function(o){e.$set(e.symbol,"lineColor",o)},expression:"symbol.lineColor"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.type==="polygon",expression:"item.type==='polygon'"}],staticClass:"l-h"},[t("label",[e._v("\u7EBF\u900F\u660E\u5EA6\uFF1A")]),t("el-input-number",{attrs:{min:.1,max:1,precision:1,step:.1,size:"small"},on:{change:function(o){return e.callback("lineOpacity",e.lineOpacity)}},model:{value:e.symbol.lineOpacity,callback:function(o){e.$set(e.symbol,"lineOpacity",o)},expression:"symbol.lineOpacity"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.type==="polygon",expression:"item.type==='polygon'"}],staticClass:"l-h"},[t("label",[e._v("\u586B\u5145\u989C\u8272\uFF1A")]),t("el-color-picker",{on:{change:function(o){return e.callback("polygonFill",e.polygonFill)}},model:{value:e.symbol.polygonFill,callback:function(o){e.$set(e.symbol,"polygonFill",o)},expression:"symbol.polygonFill"}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.item.type==="polygon",expression:"item.type==='polygon'"}],staticClass:"l-h"},[t("label",[e._v("\u586B\u5145\u900F\u660E\u5EA6\uFF1A")]),t("el-input-number",{attrs:{min:.1,max:1,precision:1,step:.1,size:"small"},on:{change:function(o){return e.callback("polygonOpacity",e.polygonOpacity)}},model:{value:e.symbol.polygonOpacity,callback:function(o){e.$set(e.symbol,"polygonOpacity",o)},expression:"symbol.polygonOpacity"}})],1)])])])},w=[],$=a(x,k,w,!1,null,"55ed0e8c",null,null);const d=$.exports;let i,n;const S={components:{MapMain:m,MapArea:r,MapPlotEdit:d},computed:{...u({map:"MapModule/map"})},data(){return{editItem:null}},mounted(){this.$nextTick(()=>{this.initTool()})},methods:{initTool(){let l=this,e=this.map;n=e.getOrCreateLayerById("\u76D1\u63A7\u533A",{}),i=new y({mode:"Polygon",once:!0}).addTo(e.getInstance()).disable(),i.on("drawend",function(t){l.addGeometry(t)}),this.getToolBar()},getToolBar(){let l=this,e=this.map;new g.Toolbar({position:{top:15,right:50},items:[{item:"\u533A\u57DF\u5217\u8868",children:l.getGeometries()},{item:"\u65B0\u589E",click:function(){i.enable()}},{item:"\u4FDD\u5B58",click:function(){l.saveArea()}},{item:"text",click:function(){l.test()}},{item:"\u505C\u6B62\u7ED8\u5236",click:function(){i.disable()}}]}).addTo(e.getInstance())},addGeometry(l){let e=new h(l.geometry._coordinates,{id:"newSymbol",symbol:{name:"\u65B0\u589E\u533A\u57DF",description:"",tag:"",textName:"\u65B0\u589E\u533A\u57DF",textSize:12,lineColor:"#000",lineWidth:2,lineOpacity:1,polygonFill:"#fff",polygonOpacity:.3}});n.addGeometry(e),this.getToolBar()},getGeometries(){let l=this;var t=n.getGeometries().map(function(o){return{item:o.getSymbol().name,click:function(){l.editItem&&l.editItem.endEdit(),l.editItem=o,o.startEdit(),l.$refs.plotEdit.open({type:"polygon",xy:{x:20,y:20},geo:o})}}});return t},test(){this.$confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u6587\u4EF6, \u662F\u5426\u7EE7\u7EED?","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",type:"warning"}).then(()=>{this.$message("setMessage","\u5220\u9664\u6210\u529F")}).catch(()=>{this.$message("setError","\u5DF2\u53D6\u6D88\u5220\u9664")})},startDraw(){i.setMode("Polygon").enable()},stopDraw(){this.editItem&&this.editItem.endEdit(),this.editItem.endEdit(),i.disable()},saveArea(){this.editItem&&(this.editItem.endEdit(),this.$refs.plotEdit.close())},redraw(){}}};var C=function(){var e=this,t=e._self._c;return t("div",[t(m,{staticStyle:{width:"100vw",height:"100vh"}}),t(r),t(d,{ref:"plotEdit"})],1)},O=[],F=a(S,C,O,!1,null,null,null,null);const W=F.exports;export{W as default};
